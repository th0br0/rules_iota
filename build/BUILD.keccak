config_setting(
    name = "windows",
    values = {"cpu": "x64_windows_msvc"},
    visibility = ["//visibility:private"],
)

config_setting(
    name = "linux",
    values = {"cpu": "k8"},
    visibility = ["//visibility:private"],
)

config_setting(
    name = "darwin",
    values = {"cpu": "darwin"},
    visibility = ["//visibility:private"],
)

cc_library(
    name = "snp_1600_reference",
    srcs = ["SnP/KeccakP-1600/Reference/KeccakP-1600-reference.c"],
    hdrs = [
        "SnP/KeccakP-1600/Reference/KeccakP-1600-SnP.h",
        "SnP/KeccakP-1600/Reference/KeccakP-1600-reference.h",
    ],
    strip_include_prefix = "SnP/KeccakP-1600/Reference",
    deps = [":common"],
)

cc_library(
    name = "snp",
    hdrs = ["SnP/SnP-documentation.h", "SnP/SnP-Relaned.h"],
    strip_include_prefix = "SnP",
)

cc_library(
    name = "snp_1600_opt_shared",
    hdrs = [
        "SnP/KeccakP-1600/Optimized/KeccakP-1600-unrolling.macros",
        "SnP/KeccakP-1600/Optimized/KeccakP-1600-64.macros",
    ],
    strip_include_prefix = "SnP/KeccakP-1600/Optimized",
)

cc_library(
    name = "snp_1600_opt64_lcufull",
    hdrs = [
        "SnP/KeccakP-1600/Optimized64/LCufull/KeccakP-1600-opt64-config.h",
    ],
    strip_include_prefix = "SnP/KeccakP-1600/Optimized64/LCufull",
)

cc_library(
    name = "snp_1600_opt64",
    srcs = ["SnP/KeccakP-1600/Optimized64/KeccakP-1600-opt64.c"],
    hdrs = [
        "SnP/KeccakP-1600/Optimized64/KeccakP-1600-SnP.h",
    ],
    strip_include_prefix = "SnP/KeccakP-1600/Optimized64",
    deps = [":common", ":snp_1600_opt64_lcufull", ":snp_1600_opt_shared", ":snp"],
)

cc_library(
    name = "common",
    hdrs = [
        "Common/align.h",
        "Common/brg_endian.h",
    ],
    strip_include_prefix = "Common",
)

cc_library(
    name = "keccak_sponge_common",
    hdrs = [
        "Constructions/KeccakSponge.inc",
        "Constructions/KeccakSponge-common.h",
    ],
    strip_include_prefix = "Constructions",
    deps = [":common"],
)

cc_library(
    name = "keccak_sponge_1600",
    srcs = [
        "Constructions/KeccakSponge.inc",
        "Constructions/KeccakSponge-common.h",
        "Constructions/KeccakSpongeWidth1600.c",
        "Constructions/KeccakSpongeWidth1600.h",
    ],
    hdrs = [
        "Constructions/KeccakSpongeWidth1600.h",
    ],
    strip_include_prefix = "Constructions",
    deps = [
        ":keccak_sponge_common",
        ":snp_1600_opt64",
    ],
)

cc_library(
    name = "keccak",
    srcs = [
        "Modes/KeccakHash.c",
        "Modes/KeccakHash.h",
    ],
    hdrs = [
        "Modes/KeccakHash.h",
    ],
    include_prefix = "keccak",
    strip_include_prefix = "Modes",
    visibility = ["//visibility:public"],
    deps = [":keccak_sponge_1600"],
)
